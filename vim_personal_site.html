<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Freeman -- Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background-color: #1a1a1a;
            color: #c0c0c0;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            margin-bottom: 2rem;
            border-bottom: 1px solid #333;
            padding-bottom: 1rem;
        }

        .header h1 {
            color: #00ff00;
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .header .subtitle {
            color: #666;
            font-size: 1rem;
        }

        .navbar {
            display: flex;
            border-bottom: 1px solid #333;
            margin-bottom: 2rem;
            overflow-x: auto;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: #2a2a2a;
            color: #888;
            border: 1px solid #333;
            border-bottom: none;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .tab:hover {
            background: #3a3a3a;
            color: #c0c0c0;
        }

        .tab.active {
            background: #1a1a1a;
            color: #00ffff;
            border-color: #00ffff;
        }

        .tab-content {
            display: none;
            min-height: 400px;
            animation: fadeIn 0.3s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            margin-bottom: 2rem;
        }

        .section h2 {
            color: #00ffff;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            border-left: 3px solid #00ffff;
            padding-left: 0.5rem;
        }

        .section p, .section li {
            margin-bottom: 0.5rem;
        }

        .section ul {
            list-style: none;
            padding-left: 1rem;
        }

        .section li:before {
            content: "→ ";
            color: #00ff00;
        }

        .navigation {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #333;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            opacity: 0.7;
            transition: opacity 0.3s;
        }

        .navigation:hover {
            opacity: 1;
        }

        .navigation div {
            margin: 2px 0;
        }

        .command-line {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            color: #00ff00;
            padding: 10px;
            font-family: 'Courier New', monospace;
            display: none;
            border-top: 1px solid #333;
        }

        .command-line.active {
            display: block;
        }

        .command-input {
            background: transparent;
            border: none;
            color: #00ff00;
            font-family: inherit;
            font-size: inherit;
            outline: none;
            width: 100%;
        }

        .highlight {
            background: #333;
            padding: 2px 4px;
            border-radius: 2px;
        }

        .link {
            color: #00ffff;
            text-decoration: none;
            cursor: pointer;
        }

        .link:hover {
            text-decoration: underline;
        }

        .status-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #333;
            color: #00ff00;
            padding: 5px 20px;
            font-size: 0.8rem;
            display: none;
        }

        .status-bar.active {
            display: block;
        }

        @media (max-width: 600px) {
            .container {
                padding: 1rem;
            }
            
            .navigation {
                position: static;
                margin-top: 2rem;
                opacity: 1;
            }
        }

        .search-highlight {
            background-color: #d7a600;
            color: #000;
            border-radius: 3px;
        }

        .search-highlight.current {
            background-color: #ff0000;
        }

        .cursor {
            position: absolute;
            width: 8px;
            height: 20px;
            background-color: #00ff00;
            border: 1px solid #00ff00;
            z-index: 1000;
            pointer-events: none;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .cursor.solid {
            animation: none;
            opacity: 1;
        }

        .cursor-hover-link {
            background-color: #004400 !important;
            border: 1px solid #00ff00 !important;
            box-shadow: 0 0 5px rgba(0, 255, 0, 0.5) !important;
        }

        .cursor-hover-tab {
            background-color: #004466 !important;
            border: 1px solid #00ffff !important;
            box-shadow: 0 0 5px rgba(0, 255, 255, 0.5) !important;
        }
    </style>
</head>
<body>
    <div class="status-bar" id="statusBar">
        NORMAL MODE | Press ? for help
    </div>

    <div class="container">
        <div class="header">
            <h1>Noryve Freeman</h1>
            <div class="subtitle">I build things and love configs</div>
        </div>

        <div class="navbar">
            <div class="tab active" data-tab="about">About</div>
            <div class="tab" data-tab="blog">Blog</div>
            <div class="tab" data-tab="books">Books</div>
            <div class="tab" data-tab="awesome-links">Awesome Links</div>
        </div>

        <div class="tab-content active" id="about">
            <div class="section">
                <h2>About</h2>
                I am a student at <a href="https://www.yale.edu" class="link" target="_blank">Yale University</a>, studying Computer Science and Energy studies. I believe in <a href="https://www.lesswrong.com/posts/Wg6ptgi2DupFuAnXG/orienting-toward-wizard-power" class="link"> "orienting towards wizard power," </a> <a href="https://paulgraham.com/identity.html" class="link"> "keeping my identity small,"</a> and <a href="https://www.benkuhn.net/abyss/" class="link"> "staring into the abyss as a core life skill."</a><br>
                I am currently building a robotics company. <br> 
                I am a big fan of <a href="https://neovim.io" class="link" target="_blank">Neovim</a>, <a href="https://github.com/tmux/tmux/wiki" class="link">tmux</a>, <a href="https://ohmyz.sh/" class="link"> and oh-my-zsh. </a>
                <br><br>
                <p>Contact me:</p>
                <ul>
                    <li>freemanirabaruta@gmail.com</li>
                    <li>LinkedIn: /in/freeman-irabaruta-7213981a0/</li>
                    <li>GitHub: /noryve-03</li>
                </ul>
            </div>
        </div>

        <div class="tab-content" id="blog">
            <div class="section">
                <h2>Blog</h2>
                <p>Recent thoughts and writings:</p>
                <ul>
                    <li><a href="#" class="link">The Future of Robotics in Education</a> - Exploring how automation can transform learning</li>
                    <li><a href="#" class="link">Vim Workflows for Productivity</a> - My daily development setup and tricks</li>
                    <li><a href="#" class="link">Building at Yale</a> - Reflections on student entrepreneurship</li>
                    <li><a href="#" class="link">Energy and Computing</a> - The intersection of my two fields of study</li>
                    <li><a href="#" class="link">Terminal Aesthetics</a> - Why I spend so much time on my dotfiles</li>
                </ul>
            </div>
        </div>

        <div class="tab-content" id="books">
            <div class="section">
                <h2>Books</h2>
                <p>Books I read in 2025</p>
                <ul>
                    <li><a href="https://www.goodreads.com/book/show/12857" class="link" target="_blank">The Gambler</a> - Fyodor Dostoevsky</li>
                    <li><a href="https://www.goodreads.com/book/show/39330937" class="link" target="_blank">Laws of Human Nature</a> - Robert Greene</li>
                    <li><a href="https://www.goodreads.com/book/show/213034913" class="link" target="_blank">Bill Gates – Source Code</a> - Bill Gates</li>
                    <li><a href="https://www.goodreads.com/book/show/230863846" class="link" target="_blank">God Money</a> - Dean Patrick</li>
                    <li><a href="https://www.goodreads.com/book/show/10046142" class="link" target="_blank">Dancing in the Glory of Monsters</a> - Jason Stearns</li>
                    <li><a href="https://www.goodreads.com/book/show/12158480-why-nations-fail" class="link" target="_blank">Why Nations Fail</a> - Daron Acemoglu</li>
                    <li><a href="https://www.goodreads.com/book/show/10569.On_Writing" class="link" target="_blank">On Writing</a> - Stephen King</li>
                    <li><a href="https://www.goodreads.com/book/show/43062156" class="link" target="_blank">All the Wrong Moves</a> - Sasha Chapin</li>
                    <li><a href="https://www.goodreads.com/book/show/7936425" class="link" target="_blank">More Money Than God</a> - Sebastian Mallaby</li>
                    <li><a href="https://www.goodreads.com/book/show/199798270" class="link" target="_blank">UnitX</a></li>
                    <li><a href="https://www.goodreads.com/book/show/58009109" class="link" target="_blank">The Power Law</a> - Sebastian Mallaby</li>
                    <li><a href="https://www.goodreads.com/book/show/41793" class="link" target="_blank">Hackers and Painters</a> - Paul Graham</li>
                    <li><a href="https://www.goodreads.com/book/show/98233.Founders_at_Work" class="link" target="_blank">Founders at Work</a> - Jessica Livingston</li>
                    <li><a href="https://www.goodreads.com/book/show/149105520" class="link" target="_blank">Going Infinite</a> - Michael Lewis</li>
                    <li><a href="https://www.goodreads.com/book/show/11383199" class="link" target="_blank">Cracking the Sky</a> - Desmond Prout-Johnes</li>
                    <li><a href="https://www.goodreads.com/book/show/204236707" class="link" target="_blank">On the Edge</a> - Nate Silver</li>
                    <li><a href="https://www.goodreads.com/book/show/61331847" class="link" target="_blank">Silicon Valley Porn Star</a> - Jason Portnoy</li>
                    <li><a href="https://www.goodreads.com/book/show/15750692" class="link" target="_blank">Malice</a> - John Gwynne</li>
                </ul>
                <p>Currently reading or not finished:</p>
                <ul>
                    <li><a href="https://www.goodreads.com/book/show/86058.Master_of_the_Senate" class="link" target="_blank">Master of the Senate</a> - Robert Caro</li>
                    <li><a href="https://www.goodreads.com/book/show/656.Anna_Karenina" class="link" target="_blank">Anna Karenina</a> - Leo Tolstoy</li>
                    <li><a href="https://www.goodreads.com/book/show/10483171-the-beginning-of-infinity" class="link" target="_blank">The Beginning of Infinity</a> - David Deutsch</li>
                    <li><a href="https://www.goodreads.com/book/show/130507.Orthodoxy" class="link" target="_blank">Orthodoxy</a> - G.K. Chesterton</li>
                </ul>
            </div>
        </div>

        <div class="tab-content" id="awesome-links">
            <div class="section">
                <h2>Awesome Links</h2>
                <p>Resources, tools, and sites I find valuable:</p>
                <ul>
                    <li><a href="https://hacker-tools.github.io/" class="link" target="_blank">MIT Missing Semester</a> - Essential tools for computer science</li>
                    <li><a href="https://www.lesswrong.com/" class="link" target="_blank">LessWrong</a> - Rationality and effective thinking</li>
                    <li><a href="https://www.gwern.net/" class="link" target="_blank">Gwern.net</a> - Deep dives into fascinating topics</li>
                    <li><a href="https://waitbutwhy.com/" class="link" target="_blank">Wait But Why</a> - Long-form explanations of complex topics</li>
                    <li><a href="https://vimawesome.com/" class="link" target="_blank">Vim Awesome</a> - Best Vim plugins and resources</li>
                    <li><a href="https://github.com/awesome-lists/awesome" class="link" target="_blank">Awesome Lists</a> - Curated lists of everything</li>
                    <li><a href="https://lobste.rs/" class="link" target="_blank">Lobsters</a> - High-quality programming discussion</li>
                    <li><a href="https://www.marginalia.nu/" class="link" target="_blank">Marginalia Search</a> - Independent search engine</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="navigation" id="navigation">
        <div><strong>Vim Keys:</strong></div>
        <div>j/k/h/l - move cursor</div>
        <div>n/p - next/prev tab</div>
        <div>/ - search in tab</div>
        <div>: - command mode</div>
        <div>? - help</div>
    </div>

    <div class="command-line" id="commandLine">
        <span>:</span><input type="text" class="command-input" id="commandInput" placeholder="Enter command">
    </div>

    <div class="cursor" id="cursor"></div>

    <script>
        // Vim-inspired functionality
        class VimSite {
            constructor() {
                this.mode = 'normal';
                this.sections = ['about', 'blog', 'books', 'awesome-links'];
                this.currentSection = 0;
                this.searchTerm = '';
                this.searchMatches = [];
                this.currentMatchIndex = -1;
                this.scrollSpeed = 50;
                
                // Cursor position tracking
                this.cursorX = 0;
                this.cursorY = 0;
                this.lineHeight = 20;
                this.charWidth = 8;
                this.cursor = null;
                
                this.init();
            }

            init() {
                this.cursor = document.getElementById('cursor');
                this.bindEvents();
                this.bindTabEvents();
                this.showTab('about');
                this.initializeCursor();
                this.showStatus('NORMAL MODE | Press ? for help');
            }

            bindEvents() {
                document.addEventListener('keydown', (e) => this.handleKeyPress(e));
                document.getElementById('commandInput').addEventListener('keydown', (e) => this.handleCommandInput(e));
                window.addEventListener('resize', () => this.updateCursorPosition());
                window.addEventListener('scroll', () => this.updateCursorPosition());
            }

            bindTabEvents() {
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.showTab(e.target.dataset.tab);
                    });
                });
            }

            showTab(tabName) {
                // Update current section index
                this.currentSection = this.sections.indexOf(tabName);
                
                // Hide all tab contents
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Remove active class from all tabs
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // Show selected tab content
                document.getElementById(tabName).classList.add('active');
                
                // Add active class to selected tab
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                
                // Clear any existing search highlights
                this.clearSearch();
                
                // Reset scroll position to top of tab
                window.scrollTo(0, 0);
                
                // Position cursor at first text character in new tab
                this.positionCursorAtFirstText();
            }

            handleKeyPress(e) {
                if (this.mode === 'command' || this.mode === 'search') return;
                
                switch(e.key) {
                    case 'j':
                        e.preventDefault();
                        this.moveCursorDown();
                        break;
                    case 'k':
                        e.preventDefault();
                        this.moveCursorUp();
                        break;
                    case 'h':
                        e.preventDefault();
                        this.moveCursorLeft();
                        break;
                    case 'l':
                        e.preventDefault();
                        this.moveCursorRight();
                        break;
                    case 'g':
                        e.preventDefault();
                        this.scrollToTop();
                        break;
                    case 'G':
                        e.preventDefault();
                        this.scrollToBottom();
                        break;
                    case '/':
                        e.preventDefault();
                        this.enterSearchMode();
                        break;
                    case 'n':
                        e.preventDefault();
                        if (this.searchMatches.length > 0) {
                            this.nextMatch();
                        } else {
                            this.nextSection();
                        }
                        break;
                    case 'p':
                        e.preventDefault();
                        this.prevSection();
                        break;
                    case ':':
                        e.preventDefault();
                        this.enterCommandMode();
                        break;
                    case '?':
                        e.preventDefault();
                        this.showHelp();
                        break;
                    case 'Enter':
                        e.preventDefault();
                        this.handleEnterPress();
                        break;
                    case 'Escape':
                        e.preventDefault();
                        this.exitMode();
                        break;
                }
            }

            handleCommandInput(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    this.executeCommand(e.target.value);
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    this.exitMode();
                }
            }

            scrollDown() {
                window.scrollBy(0, this.scrollSpeed);
            }

            scrollUp() {
                window.scrollBy(0, -this.scrollSpeed);
            }

            scrollToTop() {
                window.scrollTo(0, 0);
                this.currentSection = 0;
                this.updateActiveSection();
            }

            scrollToBottom() {
                window.scrollTo(0, document.body.scrollHeight);
                this.currentSection = this.sections.length - 1;
                this.updateActiveSection();
            }

            initializeCursor() {
                // Position cursor at the first text character
                this.positionCursorAtFirstText();
            }

            updateCursorPosition() {
                const container = document.querySelector('.container');
                const containerRect = container.getBoundingClientRect();
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                this.cursor.style.left = (containerRect.left + this.cursorX * this.charWidth) + 'px';
                this.cursor.style.top = (containerRect.top + scrollTop + this.cursorY * this.lineHeight) + 'px';
                
                // Check for hover states after position update
                setTimeout(() => this.updateCursorHover(), 0);
            }

            moveCursorUp() {
                this.cursorY = Math.max(0, this.cursorY - 1);
                this.updateCursorPosition();
            }

            moveCursorDown() {
                this.cursorY++;
                this.updateCursorPosition();
            }

            moveCursorLeft() {
                this.cursorX = Math.max(0, this.cursorX - 1);
                this.updateCursorPosition();
            }

            moveCursorRight() {
                this.cursorX++;
                this.updateCursorPosition();
            }

            getElementAtCursor() {
                const cursorRect = this.cursor.getBoundingClientRect();
                const centerX = cursorRect.left + cursorRect.width / 2;
                const centerY = cursorRect.top + cursorRect.height / 2;
                
                // Temporarily hide cursor to get element beneath it
                this.cursor.style.display = 'none';
                const element = document.elementFromPoint(centerX, centerY);
                this.cursor.style.display = 'block';
                
                return element;
            }

            isOverLink() {
                const element = this.getElementAtCursor();
                return element && (element.tagName === 'A' || element.closest('a'));
            }

            isOverTab() {
                const element = this.getElementAtCursor();
                return element && (element.classList.contains('tab') || element.closest('.tab'));
            }

            handleEnterPress() {
                if (this.isOverLink()) {
                    this.openLinkAtCursor();
                } else if (this.isOverTab()) {
                    this.switchToTabAtCursor();
                }
            }

            openLinkAtCursor() {
                const element = this.getElementAtCursor();
                const link = element.tagName === 'A' ? element : element.closest('a');
                if (link && link.href) {
                    window.open(link.href, '_blank');
                    this.showStatus(`Opened link: ${link.href}`);
                }
            }

            switchToTabAtCursor() {
                const element = this.getElementAtCursor();
                const tab = element.classList.contains('tab') ? element : element.closest('.tab');
                if (tab && tab.dataset.tab) {
                    this.showTab(tab.dataset.tab);
                    this.showStatus(`Switched to tab: ${tab.dataset.tab}`);
                }
            }

            updateCursorHover() {
                // Clear previous hover states
                this.cursor.classList.remove('cursor-hover-link', 'cursor-hover-tab');
                
                if (this.isOverLink()) {
                    this.cursor.classList.add('cursor-hover-link');
                    const element = this.getElementAtCursor();
                    const link = element.tagName === 'A' ? element : element.closest('a');
                    const linkText = link.textContent.trim();
                    const linkUrl = link.href;
                    this.showStatus(`Link: "${linkText}" - Press Enter to open in new tab`);
                } else if (this.isOverTab()) {
                    this.cursor.classList.add('cursor-hover-tab');
                    const element = this.getElementAtCursor();
                    const tab = element.classList.contains('tab') ? element : element.closest('.tab');
                    const tabName = tab.textContent.trim();
                    this.showStatus(`Tab: "${tabName}" - Press Enter to switch`);
                } else {
                    // Clear status if not over interactive element
                    this.showStatus('NORMAL MODE | Press ? for help');
                }
            }

            findFirstTextPosition() {
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return { x: 0, y: 0 };

                // Find the first text node in the active tab
                const walker = document.createTreeWalker(
                    activeTab,
                    NodeFilter.SHOW_TEXT,
                    {
                        acceptNode: function(node) {
                            // Skip empty text nodes and whitespace-only nodes
                            if (node.nodeValue.trim().length === 0) {
                                return NodeFilter.FILTER_SKIP;
                            }
                            return NodeFilter.FILTER_ACCEPT;
                        }
                    },
                    false
                );

                const firstTextNode = walker.nextNode();
                if (!firstTextNode) return { x: 0, y: 0 };

                // Get the position of the first character
                const range = document.createRange();
                range.setStart(firstTextNode, 0);
                range.setEnd(firstTextNode, 1);
                const rect = range.getBoundingClientRect();
                
                const container = document.querySelector('.container');
                const containerRect = container.getBoundingClientRect();
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

                // Calculate relative position within the container
                const relativeX = Math.max(0, Math.floor((rect.left - containerRect.left) / this.charWidth));
                const relativeY = Math.max(0, Math.floor((rect.top - containerRect.top - scrollTop) / this.lineHeight));

                return { x: relativeX, y: relativeY };
            }

            positionCursorAtFirstText() {
                const position = this.findFirstTextPosition();
                this.cursorX = position.x;
                this.cursorY = position.y;
                this.updateCursorPosition();
            }

            nextSection() {
                this.currentSection = (this.currentSection + 1) % this.sections.length;
                this.showTab(this.sections[this.currentSection]);
            }

            prevSection() {
                this.currentSection = (this.currentSection - 1 + this.sections.length) % this.sections.length;
                this.showTab(this.sections[this.currentSection]);
            }

            scrollToSection(index) {
                // Not needed for tabs - using showTab instead
                this.showTab(this.sections[index]);
            }

            enterSearchMode() {
                this.mode = 'search';
                this.cursor.style.display = 'none';
                this.showCommandLine();
                document.getElementById('commandInput').placeholder = 'Search...';
                document.getElementById('commandInput').focus();
                this.showStatus('SEARCH MODE | Type to search, Enter to find, Esc to exit');
            }

            enterCommandMode() {
                this.mode = 'command';
                this.cursor.style.display = 'none';
                this.showCommandLine();
                document.getElementById('commandInput').placeholder = 'Enter command';
                document.getElementById('commandInput').focus();
                this.showStatus('COMMAND MODE | Type command, Enter to execute, Esc to exit');
            }

            executeCommand(command) {
                const cmd = command.trim().toLowerCase();
                
                if (this.mode === 'search') {
                    this.search(cmd);
                    return;
                }
                
                switch(cmd) {
                    case 'about':
                    case 'a':
                        this.goToSection('about');
                        break;
                    case 'blog':
                    case 'b':
                        this.goToSection('blog');
                        break;
                    case 'books':
                    case 'bk':
                        this.goToSection('books');
                        break;
                    case 'awesome-links':
                    case 'links':
                    case 'l':
                        this.goToSection('awesome-links');
                        break;
                    case 'help':
                    case 'h':
                        this.showHelp();
                        break;
                    case 'top':
                        this.scrollToTop();
                        break;
                    case 'bottom':
                        this.scrollToBottom();
                        break;
                    default:
                        this.showStatus(`Unknown command: ${command}`);
                }
                
                this.exitMode();
            }

            goToSection(sectionName) {
                const index = this.sections.indexOf(sectionName);
                if (index !== -1) {
                    this.currentSection = index;
                    this.showTab(sectionName);
                }
            }

            search(term) {
                if (!term || !term.trim()) {
                    this.searchTerm = '';
                    this.clearSearch();
                    this.exitMode();
                    return;
                }

                this.clearSearch(); // Clear previous search
                this.searchTerm = term;
                const activeTab = document.querySelector('.tab-content.active');
                const regex = new RegExp(this.escapeRegex(term), 'gi');

                const walkAndReplace = (node) => {
                    if (node.nodeType === Node.TEXT_NODE) {
                        const text = node.textContent;
                        const matches = [...text.matchAll(regex)];
                        if (matches.length > 0) {
                            const fragment = document.createDocumentFragment();
                            let lastIndex = 0;
                            matches.forEach(match => {
                                if (match.index > lastIndex) {
                                    fragment.appendChild(document.createTextNode(text.slice(lastIndex, match.index)));
                                }
                                const highlightSpan = document.createElement('span');
                                highlightSpan.className = 'search-highlight';
                                highlightSpan.textContent = match[0];
                                fragment.appendChild(highlightSpan);
                                lastIndex = match.index + match[0].length;
                            });
                            if (lastIndex < text.length) {
                                fragment.appendChild(document.createTextNode(text.slice(lastIndex)));
                            }
                            node.parentNode.replaceChild(fragment, node);
                        }
                    } else if (node.nodeType === Node.ELEMENT_NODE) {
                        // Process child nodes
                        const children = [...node.childNodes];
                        children.forEach(child => walkAndReplace(child));
                    }
                };

                walkAndReplace(activeTab);
                this.searchMatches = [...activeTab.querySelectorAll('.search-highlight')];

                if (this.searchMatches.length > 0) {
                    this.showStatus(`${this.searchMatches.length} matches found for: "${term}"`);
                    this.currentMatchIndex = -1;
                    this.nextMatch(); // Go to first match
                } else {
                    this.showStatus(`No matches found for: "${term}"`);
                }
                
                this.exitMode();
            }

            clearSearch() {
                const highlights = document.querySelectorAll('.search-highlight');
                highlights.forEach(el => {
                    const parent = el.parentNode;
                    if (parent) {
                        parent.replaceChild(document.createTextNode(el.textContent), el);
                        parent.normalize();
                    }
                });
                this.searchMatches = [];
                this.currentMatchIndex = -1;
            }

            nextMatch() {
                if (this.searchMatches.length === 0) return;

                if (this.currentMatchIndex >= 0) {
                    this.searchMatches[this.currentMatchIndex].classList.remove('current');
                }
                this.currentMatchIndex = (this.currentMatchIndex + 1) % this.searchMatches.length;
                this.highlightCurrentMatch();
            }

            highlightCurrentMatch() {
                if (this.currentMatchIndex >= 0 && this.currentMatchIndex < this.searchMatches.length) {
                    const currentMatch = this.searchMatches[this.currentMatchIndex];
                    currentMatch.classList.add('current');
                    currentMatch.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    this.showStatus(`Match ${this.currentMatchIndex + 1} of ${this.searchMatches.length}`);
                }
            }

            escapeRegex(string) {
                return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            }

            showHelp() {
                this.showStatus('Commands: a/about | b/blog | bk/books | l/links | Keys: j/k/n/p/:/? | Click tabs | Esc:exit');
            }

            exitMode() {
                this.mode = 'normal';
                this.cursor.style.display = 'block';
                this.hideCommandLine();
                this.updateCursorHover();
            }

            showCommandLine() {
                document.getElementById('commandLine').classList.add('active');
                document.getElementById('commandInput').value = '';
            }

            hideCommandLine() {
                document.getElementById('commandLine').classList.remove('active');
            }

            showStatus(message) {
                const statusBar = document.getElementById('statusBar');
                statusBar.textContent = message;
                statusBar.classList.add('active');
                
                // Auto-hide after 3 seconds
                setTimeout(() => {
                    if (statusBar.textContent === message) {
                        statusBar.classList.remove('active');
                    }
                }, 3000);
            }

            throttle(func, limit) {
                let inThrottle;
                return function() {
                    const args = arguments;
                    const context = this;
                    if (!inThrottle) {
                        func.apply(context, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                }
            }
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => new VimSite());
        } else {
            new VimSite();
        }
    </script>
</body>
</html>
